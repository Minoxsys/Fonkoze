@using Web.Areas.OutpostManagement.HtmlHelpers
@using Web.Areas.OutpostManagement.Models.Country
@model CountryOverviewModel
@section page_title{
Outpost Management Countries: Overview
}
@{
    Html.RenderPartial("_SubNavigation");
    Html.RenderPartial("_OutpostAdministrationSideBar");
}

<script type="text/javascript">
    Ext.onReady(function () {
    
        var administrationBtnId = window.res.header.navigation.administration;
        var administrationBtn = Ext.getCmp(administrationBtnId);
        administrationBtn.toggle(true);
    });
</script>
<script type="text/javascript">
Ext.onReady(function(){
    window.feature = {};
    window.feature.store = Ext.create('Ext.data.Store', {
        pageSize: 50,
        remoteSort: true,
        fields:[
            'Name'
        ],
        proxy: {
            // load using script tags for cross domain, if the data in on the same domain as
            // this page, an HttpProxy would be better
            type: 'ajax',
            url: '@Url.RouteUrl(OutpostManagementAreaRegistration.DEFAULT_ROUTE, new { controller = "Country", action = "Index" })',
            reader: {
                type:'json',
                root: 'Countries',
                totalProperty: 'TotalItems'
            },
            // sends single sort as multi parameter
            simpleSortMode: true
        },
        sorters: [{
            property: 'Name',
            direction: 'DESC'
        }]
    });
    window.feature.grid = Ext.create('Ext.grid.Panel', {
        title: 'Countries',
        store: window.feature.store,
        disableSelection: true,
        loadMask: true,
        // grid columns
        columns:[{
            text: "Name",
            dataIndex: 'Name',
            flex: 1,
            sortable: true
        },
        {
            text: "Country Abbreviation",
            dataIndex: 'ISOCode',
            sortable: true
        },

        {
            text: "Phone Prefix",
            dataIndex: 'PhonePrefix',
            sortable: true
        },

            
        ],
        // paging bar on the bottom
        bbar: Ext.create('Ext.PagingToolbar', {
            store: window.feature.store,
            displayInfo: true,
            displayMsg: 'Displaying topics {0} - {1} of {2}',
            emptyMsg: "No topics to display",
        })
    });

        var contentRes = window.res.content;
        var mainContent = Ext.getCmp(contentRes.maincontent.id);

        mainContent.add(window.feature.grid);
        window.feature.store.loadPage(1);
        });
</script>